#summary How to receive an HL7 message using jL7
#labels Phase-Implementation

= Introduction =

In this page, we'll see how we can receive an HL7 message using jL7. 


= Details =

Let's assume we have a remote system which sends us HL7 messages on port xxx. We first need to create an MLLPMetaData object which will contain the information concerning host and port we'll be listening to:

{{{
	private MLLPMetaData metaData = new MLLPMetaData(host, port);

}}}

The receiving of a message is done using an MLLPTransport object and invoking it's _receiveMessage_ method:

{{{
		MLLPTransport transport = new MLLPTransport();
		MLLPTransportable transportable = null;
		try {
			transportable = transport.receiveMessage(metaData);
		} catch (IOException e) {
			fail("IOException: " + e);
		}
		HL7Message msg = transportable.Message;
}}}

The _receiveMessage_ method returns an MLLPTransportable object which contains a reveived message in its _Message_ member variable.

Since we usually do not want to close the listening socket after every message, the _receiveMessage_ keeps an open connection which needs to be closed:

{{{
                try {
                        transport.disconnect();
                } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                }
}}}

That's it !